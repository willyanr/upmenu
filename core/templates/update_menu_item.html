{% extends 'menu.html' %}

{% block content %}
<div class="bg-gray-800 text-white p-6 rounded-lg shadow-md max-w-lg mx-auto">
    <h2 class="text-2xl font-bold mb-4 text-center">Editar Item: {{ item.name }}</h2>
    <form method="post" enctype="multipart/form-data" class="space-y-4">
        {% csrf_token %}
        <div class="flex flex-col space-y-4">
            {% for field in form %}
                {% if field.name == 'status' %}
                    <div class="flex items-center space-x-2">
                        <!-- Toggle switch input -->
                        <input id="status-toggle" type="checkbox" name="status" value="true"
                               {% if form.instance.status %}checked{% endif %}
                               class="hidden" />
                        <label for="status-toggle" class="flex items-center cursor-pointer">
                            <div class="relative">
                                <!-- Toggle switch -->
                                <div class="block bg-gray-600 w-14 h-8 rounded-full"></div>
                                <div id="dot" class="dot absolute top-1 left-1 bg-red-500 w-6 h-6 rounded-full transition-transform {% if form.instance.status %}translate-x-6{% endif %}"></div>
                            </div>
                            <span class="ml-3 text-gray-300">{{ field.label }}</span>
                        </label>
                        <!-- Valor oculto para envio -->
                        <input type="hidden" name="status" value="{% if form.instance.status %}true{% else %}false{% endif %}" />
                    </div>
                {% elif field.name == 'ingredients' %}
                    <div class="flex flex-col space-y-2">
                        <label class="text-gray-300 font-medium">{{ field.label }}</label>
                        <div class="relative">
                            {{ field }}
                            {% if field.help_text %}
                                <p class="text-gray-500 text-xs mt-1">{{ field.help_text }}</p>
                            {% endif %}
                        </div>
                        {% if field.errors %}
                            <p class="text-red-500 text-xs">{{ field.errors }}</p>
                        {% endif %}
                    </div>
                {% else %}
                    <div class="flex flex-col space-y-2">
                        <label for="{{ field.id_for_label }}" class="text-gray-300 font-medium">{{ field.label }}</label>
                        <div class="relative">
                            {{ field }}
                            {% if field.help_text %}
                                <p class="text-gray-500 text-xs mt-1">{{ field.help_text }}</p>
                            {% endif %}
                        </div>
                        {% if field.errors %}
                            <p class="text-red-500 text-xs">{{ field.errors }}</p>
                        {% endif %}
                    </div>
                {% endif %}
            {% endfor %}
        </div>
        <button type="submit" class="bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-gray-900 hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 w-full">Atualizar</button>
    </form>
    
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const toggle = document.getElementById('status-toggle');
            const dot = document.getElementById('dot');
            
            toggle.addEventListener('change', function() {
                const isChecked = toggle.checked;
                const hiddenInput = document.querySelector('input[name="status"][type="hidden"]');
                hiddenInput.value = isChecked ? 'true' : 'false';
                dot.classList.toggle('translate-x-6', isChecked);
            });
        });
    </script>
    
    <a href="{% url 'menu' %}" class="block mt-4 text-red-500 underline text-center hover:text-red-700">Cancelar</a>
</div>

<style>
/* Adicione este CSS dentro de uma tag <style> ou em um arquivo CSS separado */
.relative .dot {
    transition: transform 0.3s;
}
input:checked + label .dot {
    transform: translateX(100%);
}
input:checked + label .block {
    background-color: #ff0202; /* Vermelho */
    color: white;
}

#id_ingredients input {
    background-color: rgb(16, 16, 16) !important;
    border-radius: 15px !important;
    margin-right: 10px;
}
</style>
{% endblock %}
